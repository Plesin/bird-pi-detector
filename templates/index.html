<!doctype html>
<html data-theme="dim">
  <head>
    <title>Bird Camera Viewer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@latest/dist/full.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-base-200">
    <div class="min-h-screen py-8">
      <div class="max-w-full mx-auto px-4">
        <!-- Header -->
        <div class="mb-8">
          <h1 class="text-4xl font-bold text-primary mb-4">
            <svg
              class="inline-block w-10 h-10 mr-3"
              fill="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
              />
            </svg>
            Bird Camera Viewer
          </h1>
          <button class="btn btn-primary gap-2" onclick="location.reload()">
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
              ></path>
            </svg>
            Refresh Gallery
          </button>
        </div>

        <!-- Statistics -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
          <div class="stats shadow">
            <div class="stat">
              <div class="stat-figure text-primary">
                <svg
                  class="w-8 h-8"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                  ></path>
                </svg>
              </div>
              <div class="stat-title">Total Photos</div>
              <div class="stat-value text-primary">{{ photo_count }}</div>
            </div>
          </div>
          <div class="stats shadow">
            <div class="stat">
              <div class="stat-figure text-primary">
                <svg
                  class="w-8 h-8"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M7 4v16a1 1 0 001 1h8a1 1 0 001-1V4m0 0h4a1 1 0 011 1v2h-3V5a1 1 0 00-1-1h-4a1 1 0 00-1 1v2H3V5a1 1 0 011-1h4zm0 0V3a1 1 0 011-1h2a1 1 0 011 1v1h-4z"
                  ></path>
                </svg>
              </div>
              <div class="stat-title">Total Videos</div>
              <div class="stat-value text-primary">{{ video_count }}</div>
            </div>
          </div>
          <div class="stats shadow">
            <div class="stat">
              <div class="stat-figure text-primary">
                <svg
                  class="w-8 h-8"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                  ></path>
                </svg>
              </div>
              <div class="stat-title">Last Update</div>
              <div class="stat-value text-sm text-primary">
                {{ current_time }}
              </div>
            </div>
          </div>
        </div>

        <!-- Tabs -->
        <div role="tablist" class="tabs tabs-bordered mb-8 border-base-300">
          <input
            type="radio"
            name="tab_gallery"
            role="tab"
            class="tab"
            aria-label="Live"
            data-tab="live"
          />
          <div role="tabpanel" class="tab-content pt-8 pb-8">
            <h2
              class="text-2xl font-bold mb-6 text-base-content flex items-center gap-2"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"
                ></path>
              </svg>
              Live Stream
            </h2>
            <div
              class="relative w-full bg-base-300 rounded-lg overflow-hidden aspect-video"
            >
              <div
                class="live-spinner show absolute inset-0 flex items-center justify-center z-10"
              >
                <div class="loading loading-spinner loading-lg"></div>
              </div>
              <img
                data-src="{{ url_for('pages.video_feed') }}"
                class="live-feed w-full h-full object-cover"
                alt="Live Camera Feed"
              />
            </div>
          </div>

          <input
            type="radio"
            name="tab_gallery"
            role="tab"
            class="tab"
            aria-label="Photos"
            data-tab="photos"
            checked
          />
          <div role="tabpanel" class="tab-content pt-8 pb-8">
            <h2
              class="text-2xl font-bold mb-6 text-base-content flex items-center gap-2"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                ></path>
              </svg>
              Captured Photos{% if active_day_label %} - {{ active_day_label
              }}{% endif %}
            </h2>
            {% set media_type = 'photos' %} {% include '_day_section.html' with
            context %}
          </div>

          <input
            type="radio"
            name="tab_gallery"
            role="tab"
            class="tab"
            aria-label="Videos"
            data-tab="videos"
          />
          <div role="tabpanel" class="tab-content pt-8 pb-8">
            <h2
              class="text-2xl font-bold mb-6 text-base-content flex items-center gap-2"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M7 4v16a1 1 0 001 1h8a1 1 0 001-1V4m0 0h4a1 1 0 011 1v2h-3V5a1 1 0 00-1-1h-4a1 1 0 00-1 1v2H3V5a1 1 0 011-1h4zm0 0V3a1 1 0 011-1h2a1 1 0 011 1v1h-4z"
                ></path>
              </svg>
              Captured Videos{% if active_day_label %} - {{ active_day_label
              }}{% endif %}
            </h2>
            {% set media_type = 'videos' %} {% include '_day_section.html' with
            context %}
          </div>
        </div>
      </div>
    </div>

    <dialog class="modal modal-middle" id="photo-dialog">
      <div class="bg-base-200 p-0 flex flex-col" id="photo-modal-content">
        <div
          class="flex justify-between items-center px-6 py-4 border-b border-base-300 flex-shrink-0"
        >
          <div class="flex-1">
            <div
              class="text-sm text-base-content/70 truncate"
              id="photo-dialog-title"
            ></div>
            <div
              class="text-xs text-base-content/50 mt-1"
              id="photo-dialog-exif"
            ></div>
          </div>
          <button
            class="btn btn-sm btn-circle btn-ghost"
            aria-label="Close"
            onclick="document.getElementById('photo-dialog').close()"
          >
            âœ•
          </button>
        </div>
        <div
          class="flex-1 flex items-center justify-center px-6 py-6 overflow-auto"
        >
          <img
            id="photo-dialog-image"
            alt="Preview"
            class="max-w-full max-h-full object-contain rounded-lg"
          />
        </div>
      </div>
      <form method="dialog" class="modal-backdrop">
        <button></button>
      </form>
    </dialog>
    <script
      type="module"
      src="{{ url_for('static', filename='script.mjs') }}"
    ></script>
  </body>
</html>
